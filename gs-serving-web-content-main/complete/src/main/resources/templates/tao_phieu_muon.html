<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>T·∫°o Phi·∫øu M∆∞·ª£n</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<div class="container d-flex justify-content-center align-items-center" style="min-height: 100vh;">
    <div class="bg-white p-5 rounded shadow" style="min-width: 400px;">
        <h3 class="text-center mb-4">üìÑ T·∫°o Phi·∫øu M∆∞·ª£n S√°ch</h3>

        <!-- ‚úÖ Th√¥ng b√°o flash -->
        <div th:if="${thongBao}" class="alert text-center"
             th:classappend="${thanhCong} ? 'alert-success' : 'alert-danger'">
            <span th:text="${thongBao}"></span>
        </div>

        <form th:action="@{/phieu-muon/tao}" th:object="${phieuMuonMoi}" method="post">
            <div class="mb-3">
                <label class="form-label">T√™n ng∆∞·ªùi m∆∞·ª£n:</label>
                <input type="text" th:field="*{tenNguoiMuon}" class="form-control" required>
            </div>

            <div class="mb-3">
                <label class="form-label">T√™n s√°ch:</label>
                <input type="text" th:field="*{tenSach}" class="form-control" required>
            </div>

            <div class="mb-3">
                <label class="form-label">T√°c gi·∫£:</label>
                <input type="text" th:field="*{tacGia}" class="form-control" required>
            </div>

            <div class="mb-3">
                <label class="form-label">Ng√†y m∆∞·ª£n:</label>
                <input type="date" id="ngayMuon" th:field="*{ngayMuon}" class="form-control" required>
            </div>

            <div class="mb-4">
                <label class="form-label">Ng√†y tr·∫£ (t·ªëi ƒëa 15 ng√†y sau ng√†y m∆∞·ª£n):</label>
                <input type="date" id="ngayTra" th:field="*{ngayTra}" class="form-control" required>
            </div>

            <button type="submit" class="btn btn-success w-100 fw-bold">X√°c Nh·∫≠n</button>
        </form>

        <!-- üîô N√∫t quay v·ªÅ trang ch·ªß -->
        <a href="/" class="btn btn-outline-secondary mt-3 w-100">‚¨Ö Quay v·ªÅ Trang Ch·ªß</a>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const ngayMuonInput = document.getElementById('ngayMuon');
        const ngayTraInput = document.getElementById('ngayTra');

        ngayMuonInput.addEventListener('change', function () {
            const ngayMuon = new Date(this.value);
            if (isNaN(ngayMuon)) {
                ngayTraInput.min = '';
                ngayTraInput.max = '';
                ngayTraInput.value = '';
                return;
            }

            const maxNgayTra = new Date(ngayMuon);
            maxNgayTra.setDate(maxNgayTra.getDate() + 15);

            const formatDate = date => date.toISOString().split('T')[0];

            ngayTraInput.min = formatDate(ngayMuon);
            ngayTraInput.max = formatDate(maxNgayTra);

            const currentNgayTra = new Date(ngayTraInput.value);
            if (currentNgayTra < ngayMuon || currentNgayTra > maxNgayTra) {
                ngayTraInput.value = '';
            }
        });

        // Trigger l·∫°i s·ª± ki·ªán ƒë·ªÉ thi·∫øt l·∫≠p range n·∫øu ng√†y m∆∞·ª£n ƒë√£ c√≥ gi√° tr·ªã
        document.getElementById('ngayMuon').dispatchEvent(new Event('change'));
    });
</script>

</body>
</html>
